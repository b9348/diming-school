# 校园论坛系统功能需求说明书

## 1. 闲置模块

### 1.1 管理员权限
- **资金处理**：扣除手续费、处理/控制已付款费用。

### 1.2 自动清理机制
- **删除规则**：自发布日起 **180天** 后仍未售出且不在交易状态中，系统自动删除该闲置。

### 1.3 交易逻辑

#### 1.3.1 发布与沟通
- **发布**：默认包邮。
- **发货时限**：卖家需设置发货时限（默认24小时），对所有人可见。
- **沟通（聊一聊）**：
  - 买家点击进入详情页“聊一聊”发起私信。
  - **隐私显示**：
    - 同校同校区：不显示位置。
    - 同校不同校区：仅显示校区。
    - 不同学校：显示学校+校区。
  - **计数**：只要有一人私信，意向购买人数+1。
  - **结束**：交易结束后（确认收货后），系统清空双方对话并关闭对话框，商品下架。

#### 1.3.2 交易流程
1. **付款前**：买家可修改发货时限、编辑资料、联系方式。
2. **付款后**：不可修改信息。
3. **卖家发货**：
   - 卖家须在规定时间内点击“已发货”。
   - 若规定时间为0，视为自动线上发货。
   - **超时未发货**：费用自动退回买家，不扣手续费，商品保持在售状态。
   - **卖家取消**：未点“已发货”前卖家可随时取消订单，费用立即退回买家，不扣手续费。
4. **收货确认**：
   - 卖家发货后，买家需在 **48小时内** 点击“未收到货”。
   - **正常收货**：买家主动确认收货，或48小时无操作，费用立即到账卖家。
   - **争议流程**：
     - 买家点击“未收到货” -> 等待卖家 **48小时内** 点击“异议”。
     - 卖家超时未点异议 -> 费用自动退回买家。
     - 卖家点击异议 -> **资金冻结** -> 双方界面弹出管理员二维码（图文/多图）并提示“请联系管理员解决”。
5. **手续费规则**：
   - 确实未收到货/未发货/卖家取消：不扣手续费。
   - 其他情况：扣除手续费。

---

## 2. 跑腿模块

### 2.1 管理员权限
- **资金与保证金**：扣除手续费、控制已付费用、控制接单人保证金。
- **保证金设置**：默认最低5元，不足则无法接单，需补齐；未接单时可随时提现；设为0则无需缴纳。

### 2.2 自动下架机制
- **规则**：自发布日起 **3天** 后无人接单且不在交易中，订单自动下架。

### 2.3 跑腿逻辑

#### 2.3.1 发布与接单
- **发单**：必选完成时长（默认24小时），设为0则不倒计时。
- **接单前修改**：修改后时间对所有人可见。
- **接单后修改**：只能修改完成时间（只能延长），仅对接单人同步显示。

#### 2.3.2 场景一：下单后无人接单
1. **取消**：发单人可随时免费取消，费用退回原账户。
2. **超时**：3天无人接单，自动下架退款。

#### 2.3.3 场景二：下单后有人接单
- **信息展示**：接单人可见隐藏信息，双方互见联系方式及“沟通”按钮（隐私规则同闲置）。
- **系统通知**：
  - 通知发单人：任务已被接单。
  - 通知接单人：请在规定时间内完成并点击“完成”，否则退款；延时需联系修改。

**A. 接单后 30分钟内**
- **发单人取消**：免费取消，任务下架，无手续费。
- **接单人取消**：免费取消，任务回滚至“待接单”状态。

**B. 接单后 超过30分钟**
1. **发单人取消订单**：
   - 填写原因（选填），任务下架。
   - **通知接单人**：需在 **24小时内** 点击“同意”或“异议”。
   - **接单人同意/超时**：费用退回发单人，**发单人产生手续费**。
   - **接单人异议**：费用冻结 -> 跳转管理员二维码 -> 管理员介入。
     - 协商结果：接单人获赔部分或全部（扣手续费）；未获赔则退回发单人（扣手续费）。

2. **接单人取消订单**：
   - 填写原因（选填），任务回滚至“待接单”。
   - **通知发单人**：需在 **24小时内** 点击“同意”或“异议”。
   - **发单人同意/超时**：视为同意取消。
   - **发单人异议**：系统自动扣除接单人保证金赔偿给发单人（**发单价的10%**）。若保证金不足扣除，接单人将无法继续接单。

#### 2.3.4 完成与验收
- 接单人点击“完成”后，通知发单人。
- **发单人确认**：
  - **主动确认**：费用立即到账接单人。
  - **超时**：24小时未操作，费用自动到账接单人。
  - **未收到货**：发单人24小时内点击“未收到货” -> 等待接单人 **24小时内** 异议。
    - 接单人无异议：费用退回发单人，扣除接单人保证金（**发单价的15%**）给发单人。
    - 接单人异议：双方弹出管理员二维码介入。
- **最终裁决**：
  - 确实未收到货：不扣手续费，扣接单人保证金（**发单价的20%**）给发单人。
  - 确实已收到货：费用给接单人，扣除手续费。

---

## 3. 拍卖模块

### 3.1 管理员权限
- 资金控制、手续费扣除、双方保证金管理。

### 3.2 拍卖逻辑

#### 3.2.1 发布设置
- **参数**：起拍价（默认0）、加价幅度、加价更新时间（最高30分钟）、可见范围、开始时间（预约最长30天）。
- **门槛**：发布和出价均需缴纳保证金（最低1元）。
- **隐私**：发布人联系方式仅对拍中人可见。

#### 3.2.2 拍卖后流程
- **拍中通知**：
  - 通知拍中人：**24小时内** 付款，否则扣保证金。
  - 通知发布人：等待付款，超时将获赔偿。

1. **超时未付款**：
   - 拍卖自动下架。
   - 扣除拍中人保证金（**拍中价的50%**）赔偿给发布人。
   - 通知发布人重新发起。

2. **拍中并付款**：
   - 双方展示联系方式，开启沟通（隐私规则同闲置）。
   - **通知双方**：请在 **24小时内** 联系对方完成交易。

#### 3.2.3 异常流程（联系不上/未收到货）
- **拍中人视角**：
  - 付款24小时后仍未收货/失联 -> 点击“联系不上对方”。
  - 系统通知发布人：需 **24小时内** 点击“异议”。
  - **结果**：
    - 发布人超时未处理：费用退回拍中人（不扣手续费）。
    - 拍中人获赔偿金（从发布人保证金扣）。

- **发布人视角**：
  - 付款24小时后仍联系不上对方 -> 点击“联系不上对方”。
  - 系统通知拍中人：需 **24小时内** 点击“异议”。
  - **结果**：
    - 拍中人超时未处理：拍卖费到账发布人（扣手续费）。

- **异议处理**：任一方点击“异议”，提示联系管理员解决。

#### 3.2.4 收货
- 拍中人可随时点击“确认收货”，费用立即到账发布人。
- **手续费**：除“联系不上/确实未收到货”外，凡产生费用流转均收手续费。

---

## 4. 用户认证与准入

### 4.1 新用户限制
- **提示**：进入时提示需在30天内认证，否则无法查看内容（显示空白）。
- **强制认证**：
  - 30天后未认证，界面空白，显示“去认证”。
  - 进入其他论坛（切换学校）必须先认证。
  - 通过小程序/公众号搜索进入，必须先选学校并认证。

### 4.2 认证流程
- 选择学校 -> 选择校区 -> 拍摄/上传学生证。

---

## 5. 管理员分级抽成模式

系统支持三种分级抽成配置：

**模式 1：全层级**
`平台总管 -> 总管理员 -> (分区管理员) -> 论坛管理员 -> 论坛子管理员`
- 上级可设置自身及下属所有层级的抽成比例。

**模式 2：标准层级**
`平台总管 -> 总管理员 -> 论坛管理员 -> 论坛子管理员`
- 平台总管设自身及总管比例；总管设自身及下属比例；论坛管理员设自身及子管理员比例。

**模式 3：扁平层级**
`平台总管 -> 论坛管理员 -> 论坛子管理员`
- 平台总管设自身及论坛管理员比例；论坛管理员设自身及子管理员比例。

---

## 6. 管理员权限详情

### 6.1 平台分管理员
- **定位**：协助平台总管，**不可提现、不可开通论坛、不可设论坛管理员**。
- **特权**：免认证进入任意论坛，管理权限与平台总管一致。

### 6.2 平台总管理员
- **核心权限**：开通论坛、人员任免（总管/论坛管理员）。
- **内容管理**：发帖、删帖、置顶、删评、封禁/解禁用户。
- **系统设置**：
  - 设置屏蔽词（触发生效但仅自己可见）。
  - 收取平台保证金。
  - 增删学校/校区/地区名单。
  - 审核学生身份。
- **数据查看**：各论坛人数。

### 6.3 通用权限（各级管理员）
- 编辑弹窗、轮播图（仅限自己管理的论坛）。
- 管理员二维码均采用图文形式，支持自定义编辑。

---

## 7. 其他功能

### 7.1 加油功能（打赏）
- **机制**：付款方付款，1分钱 = 1g油。
- **通知**：接收方收到“头像昵称+赠与金额”通知。
- **结算**：直接到账，不收提现费。

### 7.2 恋爱资料
- **有效期**：发布一年后自动下架。